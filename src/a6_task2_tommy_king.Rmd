---
title: "Environmentalism as a Source of Political Division"
author: "Tommy King"
output: html_document
---

### Introduction: 
This data analysis explores the possibility of association between environmentalism and politics. Specifically, by utilizing Pearson's Chi-squared test, we analyze the correlation and association between political party affiliation and self-identification as environmentalists or not, serving to explore the idea of environmentalism as a source of political division. 
```{r setup, include=FALSE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
# installing necessary packages
library(janitor)
library(here)
library(tidyverse)
library(broom)
library(kableExtra)

# reading in the data and cleaning up/selecting only necessary columns
conservation_survey <- read_csv(here("data", "conservation_survey.csv")) %>% 
  clean_names() %>% 
  select(env_id, pol_or)

```

```{r}
# adding a column for political party affiliation for conservatives and liberals and excluding all other affiliations
survey_clean <- conservation_survey %>% 
  mutate(pol_party = case_when(
    pol_or %in% c(1:3) ~ "Conservative", 
    pol_or %in% c(5:7) ~ "Liberal")
  ) %>% 
  mutate(env_id = case_when(
    env_id == 1 ~ "Yes", 
         env_id == 2 ~ "No", 
         env_id == 3 ~ "Unsure"
         )) %>% 
  drop_na(pol_party)
```

```{r}
# creating a finalized tables that shows the counts and proportions of liberal and conservative survey respondents who consider themselves environmentalists or not. 

party_table <- survey_clean %>% 
  tabyl(pol_party, env_id)

# Adding counts AND proportions to table

party_props <- party_table %>% 
  adorn_percentages() %>% 
  adorn_pct_formatting(digits = 2) %>% 
  adorn_ns() 
  
  # re-order of columnns for "yes, no, unsure" order

party_props <- party_props[,c(1, 4, 2, 3)]
  


# finalizing table for publication

kable(party_props, 
      caption = str_wrap("Table 1: Political Party Affiliation and Whether or Not they Consider Themselves to be Environmentalists"), 
      col = c("Political Party", "Yes", "No", "Unsure")) %>% 
  kable_styling(bootstrap_options = c("striped", "hover"))



```

```{r}
# changing data table to chi-square test format
party_ct <- party_table %>% 
  column_to_rownames(var = "pol_party")
```

```{r}
# Running chi-square test 
party_ct2 <- chisq.test(party_ct)
#party_ct2

# making chi-square data tidy and readable
party_tidy <- tidy(party_ct2)
```
### Data Interpretation and Takeaways: 
According to this data, there is a significant association between political party association and self-identification of environmentalist, as ($\chi$^2^(`r party_tidy$parameter`) = `r round(party_tidy$statistic,2)`, *p* = `r round(party_tidy$p.value, 3)`). Among the conservatives surveyed, only `r party_props[1,2]` self-identified as environmentalists, while `r party_props[1,3]` stated that they were not environmentalists and `r party_props[1,4]` responded as "unsure". On the other hand, among liberals surveyed, `r party_props[2,2]` self-identified as environmentalists, while `r party_props[2,3]` and `r party_props[2,4]` responded as "no" and/or "unsure". This reflects the significant association displayed between political party association and self-identification as environmentalists and serves to illustrate the political divide of environmentalism.

### Data Citation: 
Andrews Forest LTER Site and C. Batavia. 2019. Influences on charitable giving for conservation: Online survey data of 1,331 respondents across the US, August 2017 ver 3. Environmental Data Initiative. https://doi.org/10.6073/pasta/926e6270e324a1322a900da14d38b96c
